## 部署与使用

### 部署

页面可视化搭建平台项目前后端合并部署，部署一次即可正常使用。平台属于可跨平台部署项目，在Windows系统，Mac系统，Linux系统均可正常部署。

平台基于Node.js环境运行，平台部署前需要先下载并安装版本号大于等于12.16.2的Node.js环境。

平台基于Mysql数据库进行数据的存储，平台部署前需要先下载并安装版本号大于8.0.0的Mysql数据库服务器。

Node.js就绪后，通过命令行界面或控制台进入平台项目根目录，运行“npm install”命令并等待平台项目安装需要的所有依赖代码包。

Mysql数据库服务器就绪后，启动服务器，并建立一个新数据库供平台使用，取名可任意，并依据5.1节数据库表设计，建立表名、字段名、数据类型相对应的数据库表。建表完成后，进入平台项目根目录，并打开config文件夹下config.default.js文件，找到数据库连接配置对象，其代码如下所示。

```JavaScript
exports.sequelize = {
  dialect: 'mysql', // 数据库类型
  host: '127.0.0.1', // 服务器ip
  port: 3306, // 服务器端口
  username: 'root' // 用户名
  password: '123456', // 用户密码
  database: 'visual_page_editor', // 数据库名
};
```

修改配置对象使项目正确连接数据库，dialect与host属性无需变更，在port属性中配置数据库服务器的地址，username与password属性配置自己的用户名与密码，database属性配置供平台使用的数据库名。如果需要区分本地和线上环境的数据库配置，将配置对象拷贝一份到config.prod.js文件中并修改为线上数据库的配置即可。

上述步骤正确完成后，进入平台项目根目录，运行“npm run dev”命令并等待项目构建完成，当命令行或控制台出现“build completely”或“build completely with wraning”时表示构建完成，此时将自动打开浏览器并加载平台首页，若未自动加载页面，可通过浏览器访问127.0.0.1:7001地址进入平台首页，顺利访问则表示项目部署完成。

### 使用

在浏览器第一次打开平台首页地址后，默认跳转至平台登录页，首先需要注册一个新用户，点击右上方“注册”按钮进入平台注册页，依次输入所有必要信息，点击“注册”按钮请求服务器，待出现“注册成功”提示表示注册成功，如图，否则需要按照错误提示检查表单并重新尝试。
 
![image](https://github.com/user-attachments/assets/80c5b3a1-57c6-4b29-b1a8-367d837e231c)

注册成功后，返回登录页登录平台进行登录，登录成功后，自动跳转至页面列表页，此时列表内无任何页面，首先点击右上角“新建页面”按钮，在显示的输入框中填写合法的页面名后，点击“新建”按钮后，页面列表新增一个页面，如图，页面项下方的菜单依次为编辑，预览，删除功能。


首先点击页面项菜单的“编辑”菜单项，进入页面的编辑页，中间的画布为空白，此时页面不存在任何元素。
 
![image](https://github.com/user-attachments/assets/9f439104-d672-4e37-9a26-9f5ad22d03af)

下面以搭建一个简单的咨询页为例，首先在“页面配置”中填写页面和文档名称等信息，从页面左侧“组件列表”菜单中按顺序拖动两个“纯文本”组件，一个“通用表单”组件至画布中，随后点击“自定位组件”按钮切换到“自定位组件”菜单，双击添加“图片链接”组件一次以及“文字链接”组件两次，并在画布中将它们分别移动到画布左上角，左下角与右下角，如图。
 
![image](https://github.com/user-attachments/assets/6617275b-4785-4edb-9f77-7637a853eb7f)

点击画布中的组件，平台右侧自动打开“组件配置”栏，点选上方开关切换组件的配置表单与样式表单，填写表单以调整组件到想要的效果，表单会自动保存变更并将更改反映到画布中。配置一个组件完成后，点击画布中其它组件，配置栏自动切换到目标组件的配置表单，每个组件的可配置项均和配置复杂度均不相同，重复上述步骤直至所有组件配置完成，如图。
 
![image](https://github.com/user-attachments/assets/163167c0-4ca5-4aab-9d09-f6cee768e94d)

配置完成后，点击页头菜单的“保存”按钮保存页面，点击预览按钮加载实际生成的页面并对页面中的交互功能进行测试，“通用表单”组件需要返回特定数据结构的接口，在表单中输入合法数据，并点击“提交”，查看提交结果，如图。
 
![image](https://github.com/user-attachments/assets/63b5a60c-86cf-485b-8df5-82220c6e9be4)

页面制作完成后，需要发布页面供他人访问。返回编辑页，点击页头菜单的“发布”按钮打开发布页，点击左上角的“新增版本”按钮，在显示的输入框中输入版本名以新建一个版本，完成后，版本列表中可看到新增版本的版本名，创建时间以及发布情况，此时版本还未发布，点击右方的发布按钮发布该版本后，页面上方生成并显示访问链接，如图，此时任何人均可通过此访问链接访问刚制作完成的页面。也可以点击下线按钮将页面下线，此时访问链接将失效，如果创建了多个版本，切换不同版本的发布不会使访问链接改变。
 
![image](https://github.com/user-attachments/assets/93ea62dc-6fe4-46cc-a9f4-0ea7cea54a5b)

可以将当前页面配置存储为一个模板，点击编辑页左侧的“模板列表”按钮打开模板列表，点击“新建模板”，在显示的输入框中输入合法的模板名即可创建模板，在其它页面的编辑中，通过双击任意模板可将页面替换为模板的配置。
 
![image](https://github.com/user-attachments/assets/58f69eb1-d928-4841-a78b-b7d704659531)

自此，平台的核心功能已经演示完毕。得益于组件数据和样式的配置化，组件的组合丰富程度和配置丰富程度无法在受限于篇幅的使用流程描述中一一展现出来，随着组件库中组件的增多，可制作的页面类型也会更加的丰富。


## 详细实现

系统总共分为四个页面，分别为登录注册页，页面选择页，页面编辑页与页面发布页。系统的页面结构图如图

![image](https://github.com/user-attachments/assets/8b8dd109-a408-47ac-bd29-6aff02ffdf71)

 ### 登录注册

在注册登录页包含注册表单与登录表单，允许用户通过填写表单注册或登录账号来使用系统的主要功能，注册登录页的界面设计如图，登录成功后，弹出成功提示并跳转至页面选择页。

 ![image](https://github.com/user-attachments/assets/a6fe74fe-ac0c-479c-aeea-f8c799c35400)

### 页面选择

在页面选择页包含用户创建的页面列表等主要内容，可查看用户创建的所有页面以及对页面进行操作，界面设计如图，页面内主要元素包括左上方的平台标识，右上方的登录用户昵称标识以及退出登录按钮，中央部分以卡片形式罗列所有页面项，页面项顶部展示页面预览图，下方为操作菜单，每个页面项提供三种操作，从左至右分别为编辑页面、预览页面与删除页面，选择编辑页面将跳转至页面编辑页，选择预览页面将跳转至页面预览页。页面列表的右上方提供新建页面按钮，点击后按钮隐藏，显示输入页面名的表单供用户新建页面。
 
![image](https://github.com/user-attachments/assets/df43faea-354c-40b7-991c-e6f0c421d341)

### 页面编辑

页面编辑页是系统的核心功能页，用户在页面编辑页中可以使用各种功能编辑自己的页面，页面编辑页的界面设计如图，内部含有普通组件列表、自定位组件列表、模板列表、画布、组件属性编辑框、页面属性编辑框等众多供页面编辑使用的模块，整个页面从左至右划分为三部分，左边部分是各种库的陈列与选择，内部含有普通组件库、自定位组件库与模板库三个标签页，用户可通过切换标签页查看和操作其中的内容，中央是画布模块，用户可在画布中实时查看页面的当前布置，并可在画布中选择和操作已添加到页面中的组件。右边部分是各种表单编辑框，内部含有页面配置和组件配置两个标签页，用户可通过切换标签页填写页面全局配置表单和选中的组件配置表单。除外，在页头中还含有全局操作菜单，包括保存功能，预览功能与发布功能，点击预览功能跳转至页面预览页，点击发布功能跳转至页面发布页。
 
![image](https://github.com/user-attachments/assets/7ef17f11-1e5c-4dd3-b35e-394fba79ab4e)

#### 修改组件

用户选中组件时，系统将组件数据中的与组件配置相关的以及与组件样式相关的数据规范对象schema与数据对象data输入编辑器中，编辑器将解析schema生成一个网页表单，并将data中的每个属性的值填入该字段对应的表单项中，作为表单项的默认值，同时编辑器会将该属性的值与对应的表单项的值绑定起来，当用户修改表单项的值时，对表单项的值进行校验，若不符合数据规范中对该值的约束，则显示错误提示，若符合约束，则对表单项对应的数据对象属性值进行同步更新。

![image](https://github.com/user-attachments/assets/0be6009c-5d74-4e6b-b480-4738ad379c95)

数据规范对象解析生成表单的流程：

![image](https://github.com/user-attachments/assets/d05bd468-1df1-48e2-81e8-b967c0b8eaca)


### 页面预览

页面预览页提供页面或页面版本的实际渲染效果预览功能，页面预览页的界面设计如图，页面上方是预览链接，点击后将在浏览器中新增一个标签页打开该页面，页面下方实时显示了实际预览效果。
 
![image](https://github.com/user-attachments/assets/d05dd3e7-de9f-44ec-9ade-cffb0a228954)

预览功能使用后台渲染方式实现，在用户对页面配置进行更改之后，前端需要将新配置保存到后台，后台存储新配置成功后，预览页重获取新页面配置生成新页面预览，前端页面通过刷新iframe重新加载展示预览效果，后台渲染流程图可概括为图

![image](https://github.com/user-attachments/assets/8cdfca2d-d4d0-4b85-a3db-ad41a73adefd)


### 页面发布

页面发布页提供页面版本列表的查看与页面的发布等功能，页面发布页的界面设计如图，页面上方提供了页面的访问链接以及链接的二维码，中部是有一个新增版本的按钮，点击后按钮隐藏，显示输入版本名称的表单供用户新建一个页面版本，下方是页面的版本列表，显示了页面版本的基本信息和发布情况，并提供下线版本和预览页面版本的操作，点击预览按钮跳转至页面预览页。
 
![image](https://github.com/user-attachments/assets/1434626b-5a81-4bd5-8e11-bd6029a59999)

